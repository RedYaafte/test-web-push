<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>Document</title>
  </head>
  <body>
    <h1>Hello World</h1>

    <script>
      this.onpush = function(event) {
        console.log(event.data);
        // From here we can write the data to IndexedDB, send it to any open
        // windows, display a notification, etc.
      };

      navigator.serviceWorker.register("/static/serviceworker.js");

      // Use serviceWorker.ready to ensure that you can subscribe for push
      navigator.serviceWorker.ready.then(function(serviceWorkerRegistration) {
        var options = {
          userVisibleOnly: true,
          applicationServerKey: applicationServerKey
        };
        serviceWorkerRegistration.pushManager.subscribe(options).then(
          function(pushSubscription) {
            console.log(pushSubscription.endpoint);
            // The push subscription details needed by the application
            // server are now available, and can be sent to it using,
            // for example, an XMLHttpRequest.
          },
          function(error) {
            // During development it often helps to log errors to the
            // console. In a production environment it might make sense to
            // also report information about errors back to the
            // application server.
            console.log(error);
          }
        );
      });
    </script>
  </body>
</html>
